# ğŸ¤– AstrBot Config Manager

> **AstrBot æ¨¡å—åŒ–é…ç½®ç®¡ç†æ¨¡æ¿**ï¼šå°†ç¹ççš„å•ä½“é…ç½®æ–‡ä»¶æ‹†åˆ†ä¸ºå¯å¤ç”¨çš„åŠŸèƒ½æ¨¡å—ï¼Œé€šè¿‡ Git å®ç°ç‰ˆæœ¬æ§åˆ¶ã€å¤šå®ä¾‹ç®¡ç†ä¸è‡ªåŠ¨åŒ–éƒ¨ç½²ã€‚

---

## ğŸ’¡ ä¸ºä»€ä¹ˆè¦è¿™æ ·åšï¼Ÿ (The Benefits)

ä¼ ç»Ÿçš„ AstrBot é…ç½®ï¼ˆ`cmd_config.json`ï¼‰é€šå¸¸æ˜¯ä¸€ä¸ªæ•°åƒè¡Œçš„å•ä½“ JSON æ–‡ä»¶ï¼Œè¿™å¸¦æ¥äº†ä»¥ä¸‹é—®é¢˜ï¼š
- **ç»´æŠ¤éš¾**ï¼šä¿®æ”¹ä¸€ä¸ªæ’ä»¶å‚æ•°è¦åœ¨ä¸Šåƒè¡Œä¸­æœç´¢ã€‚
- **å¤ç”¨éš¾**ï¼šå¦‚æœæ‚¨æƒ³è¿è¡Œä¸¤ä¸ªæœºå™¨äººï¼Œå¿…é¡»ç»´æŠ¤ä¸¤ä»½å·¨å¤§çš„ã€å†…å®¹ 90% é‡å¤çš„æ–‡ä»¶ã€‚
- **é£é™©é«˜**ï¼šé…ç½®æ–‡ä»¶ä¸­æ··æ‚ç€ API Keyã€æ’ä»¶é€»è¾‘å’Œæœºå™¨äººè®¾å®šï¼Œç¨ä¸ç•™ç¥å°±ä¼šåœ¨åˆ†äº«é…ç½®æ—¶æ³„éœ²æ•æ„Ÿä¿¡æ¯ã€‚
- **æ— ç‰ˆæœ¬å›æ»š**ï¼šæ‰‹åŠ¨ä¿®æ”¹å‡ºé”™åï¼Œå¾ˆéš¾æ‰¾å›ä¹‹å‰çš„æ­£ç¡®çŠ¶æ€ã€‚

**æœ¬æ–¹æ¡ˆé€šè¿‡â€œè§£è€¦â€è§£å†³ä»¥ä¸Šç—›ç‚¹ï¼š**
- **åŸå­åŒ–ä¿®æ”¹**ï¼šAPI Key å˜äº†ï¼Ÿåªéœ€ä¿®æ”¹ `01_credentials`ã€‚æ¨¡å‹ç­–ç•¥å˜äº†ï¼Ÿåªéœ€ä¿®æ”¹ `02_models`ã€‚
- **å¤šå®ä¾‹å¤ç”¨**ï¼šå¤šä¸ªæœºå™¨äººå¯ä»¥å…±äº«åŒä¸€å¥—æ¨¡å‹åº“æˆ–å‡­æ®åº“ã€‚
- **Git å®¡è®¡**ï¼šæ¯ä¸€æ¬¡ä¿®æ”¹éƒ½æœ‰æ®å¯æŸ¥ï¼Œéšæ—¶å›æ»šã€‚
- **è‡ªåŠ¨åŒ–æ„å»º**ï¼šåˆ©ç”¨ GitHub Actions è‡ªåŠ¨åˆå¹¶ï¼Œç¡®ä¿éƒ¨ç½²åˆ°æœåŠ¡å™¨çš„æ°¸è¿œæ˜¯æœ€æ–°ä¸”æ ¼å¼æ­£ç¡®çš„é…ç½®ã€‚

---

## ğŸ“‚ æ ·å¼å¯¹æ¯” (Style Comparison)

### 1. åŸå§‹æ ·å¼ (Before: Monolithic)
æ‰€æœ‰çš„ä¸œè¥¿éƒ½å †åœ¨ä¸€èµ·ï¼ŒåŒ…æ‹¬å¯†é’¥ã€æ¨¡å‹å‚æ•°ã€æ’ä»¶å¼€å…³ï¼š
```json
{
    "openai_api_key": "sk-...",
    "model": "gpt-4o",
    "bot_name": "MyBot",
    "port": 6181,
    "plugin_config": { ... },
    "system_prompt": "...",
    "config_version": 2
}
```

### 2. æ¨¡å—åŒ–æ ·å¼ (After: Modular)
æˆ‘ä»¬å°†å…¶æ‹†åˆ†ä¸º 5 ä¸ªé€»è¾‘ç›®å½•ï¼š
- **`01_credentials/` (å‡­æ®)**ï¼šä»…å­˜æ”¾ API Key å’Œ Tokenã€‚
- **`02_models/` (æ¨¡å‹)**ï¼šå­˜æ”¾ LLM ä¾›åº”å•†è®¾ç½®ã€æ¨¡å‹åˆ—è¡¨å’Œä»£ç†ã€‚
- **`03_core/` (æ ¸å¿ƒ)**ï¼šå­˜æ”¾æœºå™¨äººåç§°ã€ç®¡ç†å‘˜ IDã€ç³»ç»Ÿæç¤ºè¯ (Persona)ã€‚
- **`04_connectivity/` (è¿æ¥)**ï¼šå­˜æ”¾æœåŠ¡å™¨ç«¯å£ã€WebSocket è·¯å¾„ã€ç½‘ç»œä»£ç†ã€‚
- **`05_plugins/` (æ’ä»¶)**ï¼šå­˜æ”¾æ‰€æœ‰æ’ä»¶çš„å…·ä½“å¼€å…³å’Œé«˜çº§é…ç½®ã€‚

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºæ‚¨çš„ç§æœ‰ç®¡ç†åº“
1. **Fork æœ¬é¡¹ç›®**ã€‚
2. **åŠ¡å¿…è®¾ç½®ä¸ºç§æœ‰ (Private)**ï¼š
   - è¿›å…¥ä»“åº“çš„ `Settings` -> `General`ã€‚
   - æ»šåŠ¨åˆ°åº•éƒ¨ `Danger Zone` -> `Change visibility` -> **Make private**ã€‚
   - *æ³¨æ„ï¼šä¿æŠ¤æ‚¨çš„ API Key æ˜¯ç¬¬ä¸€è¦åŠ¡ã€‚*

### ç¬¬äºŒæ­¥ï¼šè¿ç§»ç°æœ‰é…ç½®
1. å°†æ‚¨ç°æœ‰çš„ `cmd_config.json` ä¸Šä¼ åˆ°ä»“åº“æ ¹ç›®å½•å¹¶æäº¤ã€‚
2. **è‡ªåŠ¨åŒ–æ‹†åˆ†**ï¼šGitHub Actions ä¼šè‡ªåŠ¨è¿è¡Œ `migrate.py`ï¼š
   - å°†å†…å®¹æŒ‰ç±»åˆ«æ‹†åˆ†åˆ° `subconfigs/` ä¸‹çš„å„ä¸ª `default.json`ã€‚
   - è‡ªåŠ¨åœ¨ `instances/` åˆ›å»ºåˆå§‹å®ä¾‹é…ç½®ã€‚
   - **è‡ªåŠ¨ç‰©ç†åˆ é™¤åŸå§‹ `cmd_config.json`**ã€‚

### ç¬¬ä¸‰æ­¥ï¼šç®¡ç†ä¸éƒ¨ç½²
- **ç®¡ç†**ï¼šä¿®æ”¹ `subconfigs/` ä¸‹çš„å°æ–‡ä»¶ï¼Œæäº¤å `generated/` ç›®å½•ä¼šè‡ªåŠ¨æ›´æ–°ã€‚
- **éƒ¨ç½²**ï¼šåœ¨æ‚¨çš„ AstrBot æœåŠ¡å™¨ä¸Š `git clone` æ‚¨çš„ç§æœ‰ä»“åº“ï¼Œå¹¶å°†æœºå™¨äººæŒ‚è½½åˆ° `generated/` ä¸‹çš„å¯¹åº”æ–‡ä»¶ã€‚

```yaml
# docker-compose.yml ç¤ºä¾‹
volumes:
  - ./astrbot_config_manager/generated/astrbot01_cmd_config.json:/AstrBot/data/cmd_config.json
```

---

## ğŸ›  æŠ€æœ¯ç»†èŠ‚
æœ¬é¡¹ç›®åŸºäº Python å®ç°ã€‚`build.py` ä¼šè¯»å– `instances/` ä¸­çš„ç»„åˆå®šä¹‰ï¼Œå°†é€‰å®šçš„å­æ¨¡å— JSON åˆå¹¶ä¸ºä¸€ä¸ªç¬¦åˆ AstrBot è§„èŒƒçš„ `config_version: 2` å®Œæ•´æ–‡ä»¶ã€‚